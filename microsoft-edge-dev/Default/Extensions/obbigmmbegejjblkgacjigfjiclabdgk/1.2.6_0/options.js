var e=0,n=1e3;const t="onboarding_shown_key";function o(e,n,t){return`<div class='website row separator'>\n            <div class='row'>\n                <img src='${e}' />\n                <div class='website-name'>\n                ${n}\n                </div>\n            </div>\n            <button id="${t}">\n                Remove\n            </button>\n        </div>`}function i(){const e=document.getElementById("no-site-configed"),n=document.getElementById("configured-websites");n.innerHTML="",chrome.storage.sync.get([AUTO_READER_KEY],function(t){if(t&&t[AUTO_READER_KEY]&&t[AUTO_READER_KEY].length>0){const d=t[AUTO_READER_KEY];for(var i=0;i<d.length;i++){const e=d[i],t=document.createElement("div"),c="chrome://favicon/https://"+e,l="button-1-"+e;t.innerHTML=o(c,e,l),n.appendChild(t),document.getElementById(l).addEventListener("click",s)}e.style.display="none",n.style.display="block"}else e.style.display="block",n.style.display="none"})}function s(e){e.target.id;const n=e.target.id.replace("button-1-","");setWebsiteToAutoReader(n,!1,function(){i()})}function d(){const e=document.getElementById("no-always-configed"),n=document.getElementById("always-reader-websites");n.innerHTML="",chrome.storage.sync.get([ALWAYS_START_READER_KEY],function(t){if(t&&t[ALWAYS_START_READER_KEY]&&t[ALWAYS_START_READER_KEY].length>0){const s=t[ALWAYS_START_READER_KEY];for(var i=0;i<s.length;i++){const e=s[i],t=document.createElement("div"),d="chrome://favicon/https://"+e,l="button-2-"+e;t.innerHTML=o(d,e,l),n.appendChild(t),document.getElementById(l).addEventListener("click",c)}e.style.display="none",n.style.display="block"}else e.style.display="block",n.style.display="none"})}function c(e){e.target.id;const n=e.target.id.replace("button-2-","");setWebsiteToAlwaysStartReader(n,!1,function(){d()})}function l(e){e.target.id;const n=e.target.id.replace("button-","");window.open(n,"_blank").focus()}function a(e){e?(document.getElementById("not-signedin").style.display="none",document.getElementById("dropdown-container").style.display="block",e.isAnonymous||(document.getElementById("username").innerText=e.email)):(document.getElementById("not-signedin").style.display="block",document.getElementById("dropdown-container").style.display="none")}function r(t){t.stopPropagation(),showSigninModal(function(t){"guest"==t.status?(n=500,e=20,u()):"google"==t.status&&(n=1e3,e=30,u())})}function u(){e>0&&setTimeout(()=>{e--,chrome.runtime.sendMessage({fromTOS:!0,type:"getCurrentUser"},function(n){if(n&&n.currentUser){e=0,a(n.currentUser)}else u()})},n)}function g(e){e.stopPropagation(),document.getElementById("signin-dropdown").style.display="block"}function m(e){e.stopPropagation(),document.getElementById("signin-dropdown").style.display="none",chrome.runtime.sendMessage({fromTOS:!0,type:"signout"},function(e){a()})}function y(){var e="mailto:readerview.extension@gmail.com?subject="+escape("Hello Best Reader");window.location.href=e}document.addEventListener("DOMContentLoaded",function(){chrome.tabs.query({active:!0,currentWindow:!0},function(e){e[0],e[0].url}),a(),e=1,n=10,u(),i(),d(),function(){const e=document.getElementById("no-highlight-note"),n=document.getElementById("Highlights-Notes");n.innerHTML="",fetchNoteHighlightedUrls(function(t){if(Object.keys(t).length<1)n.style.display="none",e.style.display="block";else{n.style.display="block",e.style.display="none";for(let[e,o]of Object.entries(t)){const t=document.createElement("div"),i="chrome://favicon/"+e;t.innerHTML=`<div class='website row separator'>\n            <div class='row'>\n                <img src='${i}' />\n                <div class='website-name'>\n                ${o}\n                </div>\n            </div>\n            <button id="button-${e}">\n                &nbsp;go&nbsp;\n            </button>\n        </div>`,n.appendChild(t),document.getElementById(`button-${e}`).addEventListener("click",l)}}})}(),chrome.storage.sync.get([t],function(e){e&&e[t]||(showOnboardingModal(),chrome.storage.sync.set({[t]:1},function(){}))}),document.getElementById("logout").addEventListener("click",m,!0),document.getElementById("not-signedin").addEventListener("click",r,!0),document.getElementById("signedin").addEventListener("click",g,!0),document.getElementById("contact").addEventListener("click",y,!0),updateRadiosFromSettings();var o=document.changeButtonColor.radios;for(let e=0;e<o.length;e++)o[e].addEventListener("change",function(){saveNewRadiosSettings(o.value)})}),window.onclick=function(e){e.target.matches(".dropbtn")||(document.getElementById("signin-dropdown").style.display="none")};